{"version":3,"sources":["jquery.countdown.js"],"names":["factory","define","amd","jQuery","$","parseDateString","dateString","Date","String","match","matchers","Number","replace","Error","escapedRegExp","str","sanitize","toString","RegExp","strftime","offsetObject","format","directives","i","len","length","directive","regexp","modifier","plural","value","DIRECTIVE_KEY_MAP","hasOwnProperty","pluralize","count","singular","split","Math","abs","instances","defaultOptions","precision","elapse","defer","push","source","join","Y","m","n","d","w","W","H","M","S","D","I","N","T","Countdown","el","finalDate","options","this","$el","interval","offset","extend","instanceNumber","data","on","setFinalDate","start","prototype","clearInterval","self","update","setInterval","call","stop","dispatchEvent","toggle","pause","resume","remove","countdownInstance","closest","newTotalSecsLeft","hasEventsAttached","undefined","_data","now","getTime","ceil","totalSecsLeft","elapsed","seconds","minutes","floor","hours","days","daysToWeek","daysToMonth","weeks","weeksToMonth","months","years","getFullYear","totalDays","totalHours","totalMinutes","totalSeconds","eventName","event","Event","trigger","fn","countdown","argumentsArray","Array","slice","arguments","each","instance","method","apply","error"],"mappings":"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","file":"jquery.countdown.js","sourcesContent":["\"use strict\";\r\n\r\n(function (factory) {\r\n    \"use strict\";\r\n\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define([\"jquery\"], factory);\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n})(function ($) {\r\n    \"use strict\";\r\n\r\n    var instances = [],\r\n        matchers = [],\r\n        defaultOptions = {\r\n        precision: 100,\r\n        elapse: false,\r\n        defer: false\r\n    };\r\n    matchers.push(/^[0-9]*$/.source);\r\n    matchers.push(/([0-9]{1,2}\\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source);\r\n    matchers.push(/[0-9]{4}([\\/\\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source);\r\n    matchers = new RegExp(matchers.join(\"|\"));\r\n    function parseDateString(dateString) {\r\n        if (dateString instanceof Date) {\r\n            return dateString;\r\n        }\r\n        if (String(dateString).match(matchers)) {\r\n            if (String(dateString).match(/^[0-9]*$/)) {\r\n                dateString = Number(dateString);\r\n            }\r\n            if (String(dateString).match(/\\-/)) {\r\n                dateString = String(dateString).replace(/\\-/g, \"/\");\r\n            }\r\n            return new Date(dateString);\r\n        } else {\r\n            throw new Error(\"Couldn't cast `\" + dateString + \"` to a date object.\");\r\n        }\r\n    }\r\n    var DIRECTIVE_KEY_MAP = {\r\n        Y: \"years\",\r\n        m: \"months\",\r\n        n: \"daysToMonth\",\r\n        d: \"daysToWeek\",\r\n        w: \"weeks\",\r\n        W: \"weeksToMonth\",\r\n        H: \"hours\",\r\n        M: \"minutes\",\r\n        S: \"seconds\",\r\n        D: \"totalDays\",\r\n        I: \"totalHours\",\r\n        N: \"totalMinutes\",\r\n        T: \"totalSeconds\"\r\n    };\r\n    function escapedRegExp(str) {\r\n        var sanitize = str.toString().replace(/([.?*+^$[\\]\\\\(){}|-])/g, \"\\\\$1\");\r\n        return new RegExp(sanitize);\r\n    }\r\n    function strftime(offsetObject) {\r\n        return function (format) {\r\n            var directives = format.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);\r\n            if (directives) {\r\n                for (var i = 0, len = directives.length; i < len; ++i) {\r\n                    var directive = directives[i].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),\r\n                        regexp = escapedRegExp(directive[0]),\r\n                        modifier = directive[1] || \"\",\r\n                        plural = directive[3] || \"\",\r\n                        value = null;\r\n                    directive = directive[2];\r\n                    if (DIRECTIVE_KEY_MAP.hasOwnProperty(directive)) {\r\n                        value = DIRECTIVE_KEY_MAP[directive];\r\n                        value = Number(offsetObject[value]);\r\n                    }\r\n                    if (value !== null) {\r\n                        if (modifier === \"!\") {\r\n                            value = pluralize(plural, value);\r\n                        }\r\n                        if (modifier === \"\") {\r\n                            if (value < 10) {\r\n                                value = \"0\" + value.toString();\r\n                            }\r\n                        }\r\n                        format = format.replace(regexp, value.toString());\r\n                    }\r\n                }\r\n            }\r\n            format = format.replace(/%%/, \"%\");\r\n            return format;\r\n        };\r\n    }\r\n    function pluralize(format, count) {\r\n        var plural = \"s\",\r\n            singular = \"\";\r\n        if (format) {\r\n            format = format.replace(/(:|;|\\s)/gi, \"\").split(/\\,/);\r\n            if (format.length === 1) {\r\n                plural = format[0];\r\n            } else {\r\n                singular = format[0];\r\n                plural = format[1];\r\n            }\r\n        }\r\n        if (Math.abs(count) > 1) {\r\n            return plural;\r\n        } else {\r\n            return singular;\r\n        }\r\n    }\r\n    var Countdown = function Countdown(el, finalDate, options) {\r\n        this.el = el;\r\n        this.$el = $(el);\r\n        this.interval = null;\r\n        this.offset = {};\r\n        this.options = $.extend({}, defaultOptions);\r\n        this.instanceNumber = instances.length;\r\n        instances.push(this);\r\n        this.$el.data(\"countdown-instance\", this.instanceNumber);\r\n        if (options) {\r\n            if (typeof options === \"function\") {\r\n                this.$el.on(\"update.countdown\", options);\r\n                this.$el.on(\"stoped.countdown\", options);\r\n                this.$el.on(\"finish.countdown\", options);\r\n            } else {\r\n                this.options = $.extend({}, defaultOptions, options);\r\n            }\r\n        }\r\n        this.setFinalDate(finalDate);\r\n        if (this.options.defer === false) {\r\n            this.start();\r\n        }\r\n    };\r\n    $.extend(Countdown.prototype, {\r\n        start: function start() {\r\n            if (this.interval !== null) {\r\n                clearInterval(this.interval);\r\n            }\r\n            var self = this;\r\n            this.update();\r\n            this.interval = setInterval(function () {\r\n                self.update.call(self);\r\n            }, this.options.precision);\r\n        },\r\n        stop: function stop() {\r\n            clearInterval(this.interval);\r\n            this.interval = null;\r\n            this.dispatchEvent(\"stoped\");\r\n        },\r\n        toggle: function toggle() {\r\n            if (this.interval) {\r\n                this.stop();\r\n            } else {\r\n                this.start();\r\n            }\r\n        },\r\n        pause: function pause() {\r\n            this.stop();\r\n        },\r\n        resume: function resume() {\r\n            this.start();\r\n        },\r\n        remove: function remove() {\r\n            this.stop.call(this);\r\n            instances[this.instanceNumber] = null;\r\n            delete this.$el.data().countdownInstance;\r\n        },\r\n        setFinalDate: function setFinalDate(value) {\r\n            this.finalDate = parseDateString(value);\r\n        },\r\n        update: function update() {\r\n            if (this.$el.closest(\"html\").length === 0) {\r\n                this.remove();\r\n                return;\r\n            }\r\n            var hasEventsAttached = $._data(this.el, \"events\") !== undefined,\r\n                now = new Date(),\r\n                newTotalSecsLeft;\r\n            newTotalSecsLeft = this.finalDate.getTime() - now.getTime();\r\n            newTotalSecsLeft = Math.ceil(newTotalSecsLeft / 1e3);\r\n            newTotalSecsLeft = !this.options.elapse && newTotalSecsLeft < 0 ? 0 : Math.abs(newTotalSecsLeft);\r\n            if (this.totalSecsLeft === newTotalSecsLeft || !hasEventsAttached) {\r\n                return;\r\n            } else {\r\n                this.totalSecsLeft = newTotalSecsLeft;\r\n            }\r\n            this.elapsed = now >= this.finalDate;\r\n            this.offset = {\r\n                seconds: this.totalSecsLeft % 60,\r\n                minutes: Math.floor(this.totalSecsLeft / 60) % 60,\r\n                hours: Math.floor(this.totalSecsLeft / 60 / 60) % 24,\r\n                days: Math.floor(this.totalSecsLeft / 60 / 60 / 24) % 7,\r\n                daysToWeek: Math.floor(this.totalSecsLeft / 60 / 60 / 24) % 7,\r\n                daysToMonth: Math.floor(this.totalSecsLeft / 60 / 60 / 24 % 30.4368),\r\n                weeks: Math.floor(this.totalSecsLeft / 60 / 60 / 24 / 7),\r\n                weeksToMonth: Math.floor(this.totalSecsLeft / 60 / 60 / 24 / 7) % 4,\r\n                months: Math.floor(this.totalSecsLeft / 60 / 60 / 24 / 30.4368),\r\n                years: Math.abs(this.finalDate.getFullYear() - now.getFullYear()),\r\n                totalDays: Math.floor(this.totalSecsLeft / 60 / 60 / 24),\r\n                totalHours: Math.floor(this.totalSecsLeft / 60 / 60),\r\n                totalMinutes: Math.floor(this.totalSecsLeft / 60),\r\n                totalSeconds: this.totalSecsLeft\r\n            };\r\n            if (!this.options.elapse && this.totalSecsLeft === 0) {\r\n                this.stop();\r\n                this.dispatchEvent(\"finish\");\r\n            } else {\r\n                this.dispatchEvent(\"update\");\r\n            }\r\n        },\r\n        dispatchEvent: function dispatchEvent(eventName) {\r\n            var event = $.Event(eventName + \".countdown\");\r\n            event.finalDate = this.finalDate;\r\n            event.elapsed = this.elapsed;\r\n            event.offset = $.extend({}, this.offset);\r\n            event.strftime = strftime(this.offset);\r\n            this.$el.trigger(event);\r\n        }\r\n    });\r\n    $.fn.countdown = function () {\r\n        var argumentsArray = Array.prototype.slice.call(arguments, 0);\r\n        return this.each(function () {\r\n            var instanceNumber = $(this).data(\"countdown-instance\");\r\n            if (instanceNumber !== undefined) {\r\n                var instance = instances[instanceNumber],\r\n                    method = argumentsArray[0];\r\n                if (Countdown.prototype.hasOwnProperty(method)) {\r\n                    instance[method].apply(instance, argumentsArray.slice(1));\r\n                } else if (String(method).match(/^[$A-Z_][0-9A-Z_$]*$/i) === null) {\r\n                    instance.setFinalDate.call(instance, method);\r\n                    instance.start();\r\n                } else {\r\n                    $.error(\"Method %s does not exist on jQuery.countdown\".replace(/\\%s/gi, method));\r\n                }\r\n            } else {\r\n                new Countdown(this, argumentsArray[0], argumentsArray[1]);\r\n            }\r\n        });\r\n    };\r\n});"]}